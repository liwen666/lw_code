DECLARE
 i NUMBER;
BEGIN
  
SELECT COUNT(1) INTO i FROM user_tables WHERE table_name = 'P#BGT_T_JBZCMXB';

IF i > 0 THEN
  
  UPDATE DICT_T_MODEL M
     SET M.RELATAB   = '1FFB71E8965441A1AB5617677A447AA4',
         M.TABLETYPE = '3',
         M.TABSWHERE =
         (SELECT T.TABSWHERE
            FROM DICT_T_MODEL T
           WHERE T.DBTABLENAME = 'BGT_T_JBZCJGB')
   WHERE M.TABLEID = 'DEB397AD6B7E4C1D96751492F6ED57B6';
   
   
  UPDATE DICT_T_FACTOR F
     SET F.FRMCOLID =
         (SELECT COLUMNID
            FROM DICT_T_FACTOR T
           WHERE T.TABLEID = '1FFB71E8965441A1AB5617677A447AA4'
             AND F.DBCOLUMNNAME = T.DBCOLUMNNAME),
         F.FRMTABID = '1FFB71E8965441A1AB5617677A447AA4'
   WHERE F.TABLEID = 'DEB397AD6B7E4C1D96751492F6ED57B6' AND F.DBCOLUMNNAME IS NOT NULL;
   
  delete from Dict_t_Factor where columnid = '79AFC79B9223479FAB42C96EE1BF309C';
  delete from Dict_t_Factor where columnid = '7C445B1E76344C72A30DEF28F525E13B';
  delete from Dict_t_Factor where columnid = 'C8B4C0C353C54DE989043A70E8B44C11';
  delete from Dict_t_Factor where columnid = 'F2D8DBFEA2E945C688D191ED8CC0AC7B';
  delete from Dict_t_Factor where columnid = 'FEC22409ACCE45F3BABC8377D0CFE418';
  delete from Dict_t_Factor where columnid = 'CDBB3139EFAC48238B98BFBB29172B19';
  delete from Dict_t_Factor where columnid = '8540DDC1FDA24106840F211D51E83025';
  delete from Dict_t_Factor where columnid = 'CEE45895C5D14A3C843D5F7B9024F36F';

   EXECUTE immediate 'DROP TABLE P#BGT_T_JBZCMXB';

   sys_p_recreate_views('DEB397AD6B7E4C1D96751492F6ED57B6');
  
  END IF;
END;--基本支出刷成单表模式
