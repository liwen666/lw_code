BEGIN
EXECUTE IMMEDIATE Q'{
CREATE OR REPLACE VIEW CODE_T_AGENCY_SPFDL AS
SELECT GUID,
       CODE,
       '['||CODE||']'||NAME NAME,
       SUPERGUID,
       ISLEAF,
       LEVELNO,
       DIVTYPE,
       ISDISTRICT,
       DISTRICTID,
       DISTRICTCODE,
       DISTRICTNAME,
       DISTRICTLVL,
       AGENCYTYPE,
       GUID as ID,
       ISLEAF as EndFlag,
       f_get_lpad(code, '3-3-3-3-3-3-3') as LvlID,
       CASE
         WHEN SUPERGUID = '0' THEN
          '#'
         ELSE
          nvl(SUPERGUID, '#')
       END SuperID,
       FININTORG
FROM CODE_M_AGENCY_SPF
WHERE YEAR = GLOBAL_MULTYEAR_CZ.SECU_F_GLOBAL_PARM('YEAR')}';

delete from dict_t_modelcode where tableid ='223267AA7D472B22E050A8C021057ED5';
delete from dict_t_factorcode where tableid ='223267AA7D472B22E050A8C021057ED5';
insert into dict_t_modelcode (APPID, FASPCSID, DBTABLENAME, DYNAMICWHERE, ISLVL, ISORGID, ISREPBASE, NAME, ORDERID, SQLCON, STATUS, TABLEID)
values ('SPF', '223267AA7D472B22E050A8C021057ED5', 'CODE_T_AGENCY_SPFDL', 'guid in (select guid
                  from code_t_agency_spfdl
                 start with guid in (select AGENCYID
                                       from SPF_T_FDECLAREAGENCY
                                      where spfid = ''$SPFID$'')
                connect by prior guid = superguid)
 start with guid = ''$AGENCYID$''
connect by prior guid = superguid order by code', '0', '0', '0', '项目代录单位代码表', 1, null, '1', '223267AA7D472B22E050A8C021057ED5');
insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D482B22E050A8C021057ED5', null, 32, 3, 'GUID', null, null, '0', '0', 'GUID', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D492B22E050A8C021057ED5', null, 200, 3, 'CODE', null, null, '0', '0', 'CODE', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D4A2B22E050A8C021057ED5', null, 457, 3, 'NAME', null, null, '0', '0', 'NAME', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D4B2B22E050A8C021057ED5', null, 32, 3, 'SUPERGUID', null, null, '0', '0', 'SUPERGUID', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D4C2B22E050A8C021057ED5', null, 0, 1, 'ISLEAF', null, null, '0', '0', 'ISLEAF', null, 0, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D4D2B22E050A8C021057ED5', null, 0, 1, 'LEVELNO', null, null, '0', '0', 'LEVELNO', null, 0, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D4E2B22E050A8C021057ED5', null, 32, 3, 'DIVTYPE', null, null, '0', '0', 'DIVTYPE', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D4F2B22E050A8C021057ED5', null, 1, 3, 'ISDISTRICT', null, null, '0', '0', 'ISDISTRICT', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D502B22E050A8C021057ED5', null, 32, 3, 'DISTRICTID', null, null, '0', '0', 'DISTRICTID', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D512B22E050A8C021057ED5', null, 255, 3, 'DISTRICTCODE', null, null, '0', '0', 'DISTRICTCODE', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D522B22E050A8C021057ED5', null, 255, 3, 'DISTRICTNAME', null, null, '0', '0', 'DISTRICTNAME', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D532B22E050A8C021057ED5', null, 32, 3, 'DISTRICTLVL', null, null, '0', '0', 'DISTRICTLVL', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D542B22E050A8C021057ED5', null, 32, 3, 'AGENCYTYPE', null, null, '0', '0', 'AGENCYTYPE', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D552B22E050A8C021057ED5', null, 32, 3, 'ID', null, null, '0', '0', 'ID', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D562B22E050A8C021057ED5', null, 0, 1, 'ENDFLAG', null, null, '0', '0', 'ENDFLAG', null, 0, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D572B22E050A8C021057ED5', null, 4000, 3, 'LVLID', null, null, '0', '0', 'LVLID', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D582B22E050A8C021057ED5', null, 32, 3, 'SUPERID', null, null, '0', '0', 'SUPERID', null, null, '1', '223267AA7D472B22E050A8C021057ED5');

insert into dict_t_factorcode (BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (null, '223267AA7D592B22E050A8C021057ED5', null, 32, 3, 'FININTORG', null, null, '0', '0', 'FININTORG', null, null, '1', '223267AA7D472B22E050A8C021057ED5');
END;

--杜崇明项目代录代码表
