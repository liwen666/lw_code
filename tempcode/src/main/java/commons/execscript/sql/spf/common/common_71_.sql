DECLARE
  a integer;
  V_BAKCOL INT;
BEGIN
  SELECT COUNT(*) INTO a FROM USER_TAB_COLUMNS WHERE TABLE_NAME = 'P#SPF_T_XMSCZBLYB' AND COLUMN_NAME = 'ISWRITEOFF';
  IF a = 0 THEN
    EXECUTE IMMEDIATE Q'{ALTER TABLE P#SPF_T_XMSCZBLYB ADD ISWRITEOFF CHAR(1) DEFAULT '0'}';
    EXECUTE IMMEDIATE Q'{alter table P#SPF_T_XMSCZBLYB drop constraint PK_P#SPF_T_XMSCZBLYB cascade drop index}';
    EXECUTE IMMEDIATE Q'{alter table P#SPF_T_XMSCZBLYB add constraint PK_P#SPF_T_XMSCZBLYB primary key (PROVINCE, YEAR, STATUS, AGENCYGUID, GUID) }';
  END IF;
    delete from dict_t_factor t where t.COLUMNID = '1552C6AC3D230614E050A8C02105555B';
    insert into dict_t_factor (ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT,  PARENTNODECANCHECK, XLSXCOLUMNID)
    values (null, null, null, null, null, null, '1552C6AC3D230614E050A8C02105555B', null, 32, 3, 'ISWRITEOFF', '''0''', null, '0000000000000000000000000000000', null, null, null, null, '0', '0', '1', '0', '1', '0', '0', '0', '0', '0', '0', 1, 'ÊÇ·ñ³åµ×', '1', 124, null, null, 0, '0', null, '1', '0', '1552C6AC3D230614E050A8C0210556AB', null,  '0', null);
    SELECT COUNT(*) INTO V_BAKCOL  FROM User_Tables WHERE TABLE_NAME = UPPER('P#SPF_T_XMSCZBLYB_BAK');
    SELECT COUNT(*) INTO a FROM COLS WHERE TABLE_NAME = UPPER('P#SPF_T_XMSCZBLYB_BAK') AND COLUMN_NAME = UPPER('ISWRITEOFF');
    IF V_BAKCOL=1 AND a = 0 THEN
       EXECUTE IMMEDIATE Q'{ALTER TABLE P#SPF_T_XMSCZBLYB_BAK ADD ISWRITEOFF CHAR(1) DEFAULT '0'}';
    END IF;
    SELECT COUNT(1)  INTO a FROM DICT_T_MODEL WHERE TABLEID ='1552C6AC3D230614E050A8C0210556AB' AND ISBAK ='1';
    IF a = 1 THEN
      UPDATE DICT_T_MODEL SET ISBAK ='0' WHERE TABLEID ='1552C6AC3D230614E050A8C0210556AB' AND ISBAK ='1';
      sys_p_recreate_views('1552C6AC3D230614E050A8C0210556AB');
      UPDATE DICT_T_MODEL SET ISBAK ='1' WHERE TABLEID ='1552C6AC3D230614E050A8C0210556AB' AND ISBAK ='0';
    ELSE  
      sys_p_recreate_views('1552C6AC3D230614E050A8C0210556AB'); 
    END IF;
END;
--ÊÇ·ñ³åµ××Ö¶Î¼°Ö÷¼üÔ¼Êø
