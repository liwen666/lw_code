DECLARE
begin
EXECUTE IMMEDIATE Q'/
create or replace view spf_t_pbasecflow as
select
   cact.batchid
   ,(select title from BD_T_BATCH where batchid=cact.batchid) title
  ,cact.busitypeid
  ,cact.createuser
  ,cact.datakey
  ,cact.objectid
  ,cact.districtid
  ,cact.remark
  ,cact.sourceagencyid
  ,cact.sourcebatchid
  ,cact.step
  ,cact.targetagencyid
  ,cact.wfdirection
  ,cact.wfstatus
  ,pbase.spfid
  ,pbase.projectid
  ,pbase.agencyid
  ,pbase.PROJNAME
  ,(SELECT f.spfname FROM spf_t_fbaseinfo f where f.SPFID=pbase.SPFID) spfname
  ,1 NEEDUPDATE
    ,1 ORDERID
    ,(select busitypename from BD_T_BUSITYPE where busitypeid=cact.busitypeid) busitypename
    ,pbase.startyear FINYEAR
    ,pbase.PROJTYPEID
from spf_t_cflow_act cact
  ,spf_t_pbaseinfo pbase
where pbase.projectid = cact.objectid
/';

delete p#dict_t_factor  where columnid in('4CCC8C766C193F70E0533A06A8C0CA93','4CCC8C766C1A3F70E0533A06A8C0CA93','524C6794C8CC5700E0533906A8C0CB21','524C6794C8CE5700E0533906A8C0CB21');

for v_row in (select * from pub_t_partition_divid t where t.year <> '*') loop
begin
    insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
    values (v_row.year, v_row.districtid, '', '', '', '', '', '', '4CCC8C766C193F70E0533A06A8C0CA93', '', 200, 3, 'SPFID', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '0', '0', '0', 1, '专项id', '1', 14, '', '', null, '0', null, '1', '0', '4CCC8C766C0B3F70E0533A06A8C0CA93', '', '0', '');

    insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
    values (v_row.year, v_row.districtid, '', '', '', '', '', '', '4CCC8C766C1A3F70E0533A06A8C0CA93', '', 200, 3, 'PROJECTID', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '0', '0', '0', 1, '项目id', '1', 15, '', '', null, '0', null, '1', '0', '4CCC8C766C0B3F70E0533A06A8C0CA93', '', '0', '');


    insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
    values (v_row.year, v_row.districtid, '', '', '', '', '', '', '524C6794C8CC5700E0533906A8C0CB21', '', 200, 3, 'PROJNAME', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '1', '0', '1', 1, '项目名称', '1', 23, '', '', 0, '0', null, '1', '0', '4CCC8C766C0B3F70E0533A06A8C0CA93', '', '0', '');

    insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
    values (v_row.year, v_row.districtid, '', '', '', '', '', '', '524C6794C8CE5700E0533906A8C0CB21', '', 200, 3, 'SPFNAME', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '1', '0', '1', 1, '专项名称', '1', 24, '', '', 0, '0', null, '1', '0', '4CCC8C766C0B3F70E0533A06A8C0CA93', '', '0', '');
end;
end loop;
end;
--修改spf_t_pbasecflow视图
