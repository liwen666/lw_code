--杜崇明添加是否自动汇总字段
DECLARE
   V_COL INT;
   V_BAKCOL INT;
BEGIN
  SELECT COUNT(*) INTO V_COL   FROM COLS  WHERE TABLE_NAME = UPPER('P#SPF_T_FBASEINFO')    AND COLUMN_NAME = UPPER('SFZDHZ');
  IF V_COL=0 THEN
    EXECUTE IMMEDIATE 'ALTER TABLE P#SPF_T_FBASEINFO  ADD (  SFZDHZ  VARCHAR2(32))' ;
    delete from dict_t_factor where COLUMNID ='3889F0D63B114D37A9A2633CACD4C964';
    insert into dict_t_factor (ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
    values (null, null, null, null, null, null, '3889F0D63B114D37A9A2633CACD4C964', '1F61620487DA498B8BD0F2D015054BEB', 32, 6, 'SFZDHZ', null, null, '0000000000000000000000000000000', null, null, null, null, '0', '0', '1', '0', '1', '0', '0', '0', '1', '0', '1', 1, '是否自动汇总', '1', 37, null, null, 0, '4', null, '1', '0', '94C0F208AB0E407E9800093043FA7692', null, '0', null);
  END IF;
   SELECT COUNT(*) INTO V_BAKCOL  FROM User_Tables WHERE TABLE_NAME = UPPER('P#SPF_T_FBASEINFO_BAK');
   SELECT COUNT(*) INTO V_COL   FROM COLS  WHERE TABLE_NAME = UPPER('P#SPF_T_FBASEINFO_BAK')    AND COLUMN_NAME = UPPER('SFZDHZ');
    IF V_BAKCOL=1 AND V_COL = 0 THEN
  EXECUTE IMMEDIATE 'ALTER TABLE P#SPF_T_FBASEINFO_BAK  ADD (  SFZDHZ  VARCHAR2(32))' ;
   END IF;
    SYS_P_RECREATE_VIEWS('94C0F208AB0E407E9800093043FA7692');
END;
--杜崇明添加是否自动汇总字段
