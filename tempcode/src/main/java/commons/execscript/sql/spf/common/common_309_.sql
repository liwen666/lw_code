DECLARE
  V_SQL VARCHAR2(3000);
  V_TABLE VARCHAR2(30);
BEGIN
  V_TABLE := 'P#SPF_T_BUSINESSCHECKDEF';
  FOR C_CON IN (SELECT CONSTRAINT_NAME,TABLE_NAME FROM USER_CONSTRAINTS WHERE TABLE_NAME = V_TABLE AND CONSTRAINT_TYPE = 'P') LOOP
    V_SQL := 'ALTER TABLE '||C_CON.TABLE_NAME||' DROP CONSTRAINT '||C_CON.CONSTRAINT_NAME||' CASCADE';
    EXECUTE IMMEDIATE V_SQL;
  END LOOP;  
  FOR C_IND IN (SELECT INDEX_NAME,TABLE_NAME FROM USER_INDEXES WHERE TABLE_NAME = V_TABLE AND INDEX_TYPE IN ('FUNCTION-BASED NORMAL','NORMAL')) LOOP
    V_SQL := 'DROP INDEX '||C_IND.INDEX_NAME;
    EXECUTE IMMEDIATE V_SQL;
  END LOOP;

  EXECUTE IMMEDIATE 'ALTER TABLE '|| V_TABLE||' ADD  CONSTRAINT '||'PK_'|| V_TABLE ||' PRIMARY KEY  (PROVINCE, YEAR, STATUS, GUID)';  
  EXECUTE IMMEDIATE 'CREATE INDEX '||'IN_'||V_TABLE||' ON '||V_TABLE||'(DBVERSION,CHECKID,BUSINESSTYPE,OBJECTID,PROCESSID,TYPEFLAG,ISUSE)';
END;
--P#SPF_T_BUSINESSCHECKDEF审核规则记录表优化
