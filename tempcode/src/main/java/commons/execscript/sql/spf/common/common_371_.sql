DECLARE
begin

                  
       /*插入dealtype*/
  delete from dict_t_dealtype where dealid='64_JS';
    Insert into dict_t_dealtype (APPID,DEALID,DEALNAME,ORDERID,NEEDCONFIG,ISUNIQUE) values ('SPF','64_JS','横向项目日志',88,'0','0');
    delete from P#dict_t_model WHERE tableid ='BF84DACD7EE642588590074AEBB55E2D';
    delete from P#dict_t_factor where tableid ='BF84DACD7EE642588590074AEBB55E2D';
  DELETE FROM dict_t_defaultcol WHERE dealid ='64_JS';
  insert into dict_t_defaultcol (DEALID, ORDERID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, CSID, ISPRIMARY, ISRESERVE, GUID, STATUS, DEFAULTVALUE, ISLOGICKEY, DEID, ISVISIBLE, ISUPDATE)
  values ('64_JS', 1, '行标识', 'DATAKEY', 3, 32, null, null, '1', '1', sys_guid(), '1',  null, '1', '080001', '0', '0');
   EXECUTE IMMEDIATE Q'/    CREATE OR REPLACE VIEW SPF_T_XMBRZ AS
SELECT c.datakey,
       c.objectid,
       e.BUSITYPEID,
       c.BATCHID,
         (select title from BD_T_BATCH where batchid=c.batchid) title,
       e.AGENCYID TARGETAGENCYID,
     e.SOURCEBATCHID,
       (select busitypename from bd_t_busitype where BUSITYPEID = e.BUSITYPEID) busintypename,
       p.dbversion,
       p.agencyid,
       p.PROJECTID,
       p.PROJTYPEID,
       p.SPFID,
       e.nodeid,
       c.DISTRICTID,
       c.OBJSTATUS,
       1 NEEDUPDATE,
       1 ORDERID,
       e.WFSTATUS,
       p.startyear FINYEAR
  FROM SPF_T_BFLOW_LOG c,EFM_T_BFLOW_LOG e
  , spf_t_pbaseinfo p where c.objectid = p.PROJECTID and e.batchid=c.BATCHID/';
  
 for v_row in(select * from pub_t_partition_divid t where t.year <> '*') loop
  begin
insert into P#dict_t_model (YEAR, PROVINCE, TABLEID, NAME, ORDERID, DBTABLENAME, TABLETYPE, ISSHOW, APPID, REMARK, SUITID, DEALTYPE, ISRESERVED, INPUTLVL, ISADD, SHORTTITLE, EXTPROP, BGTLVL, SECUSQL, ISSUMTAB, ISMAN, MAINUPTAB, RELATAB, TABSWHERE, ISPARTITION, STATUS, ISBAK, INITSQL, INITSQLTIME, ISTASK, ISALLDISTRICT, DESCFILE, ISALLYEAR, INITSQLBTNNAME, ISEXCELIMP, ISREADONLY, ISSAVEFORMULA)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '项目横向日志', 2, 'SPF_T_XMBRZ', '2', '1', 'SPF', '', 'FB12E708FE56425F82EF3D89FDE0D0EF', '64_JS', '0', '3', '0', '', '0000000000000000000000000000000', '', '', '0', '0', '', '', '', '0', '1', '', '', '1', '', '', '', '', '', '', '1', '0');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '10401', '39AA56598F4F4D4C9E2E4D34F019C14B', '预算单位', 'AGENCYID', 6, 32, null, '1', '', '1708CF6F853F76EDE050A8C0210507FC', '0', 6, '0', '1', 1, '预算单位', '', '4', null, '0', '1', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '预算单位', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', '3AA942C395C8417D842DA59554AFA74D', '专项类别', 'PROJTYPEID', 6, 32, null, '1', '', '148830CAF3E61F78E050A8C021056ABE', '0', 8, '0', '1', 1, '', '', '4', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '10206', '4768D3ED940149FF9697130E100752E6', '财年', 'FINYEAR', 3, 4, 0, '1', '', '', '0', 12, '0', '1', 1, '财年', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '财年', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', '4CDEADE6A6584Y71I0533A06A8C0BCC7', '标题', 'TITLE', 3, 500, 0, '1', '', '', '1', 22, '0', '1', 1, '', '', '0', 0, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, '', '', '', '', '', '', '4DFE6244E734265DE0533906A8C0300F', '', 1, 3, 'OBJSTATUS', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '1', '0', '1', 1, '业务主体状态', '1', 15, '', '', 0, '0', null, '1', '0', 'BF84DACD7EE642588590074AEBB55E2D', '', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', '56AA54FCC857454F8C1DEDBD8587B447', '排序序号', 'ORDERID', 1, 9, 0, '1', '', '', '0', 11, '0', '1', 1, '排序序号', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '排序序号', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', '68024112F3A140A8B45A24506CB61BB3', '项目', 'OBJECTID', 3, 32, null, '1', '', '', '0', 2, '0', '1', 1, '', '', '', null, '0', '0', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, '', '', '', '', '', '', '4E100A5761927E87E0533A06A8C0D432', '', 1, 3, 'WFSTATUS', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '1', '0', '1', 1, '当前状态', '1', 23, '', '', 0, '0', null, '1', '0', 'BF84DACD7EE642588590074AEBB55E2D', '', '0', '');



insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', '888E2ADA695C45688C7102FC810B8DCD', '业务类型', 'BUSITYPEID', 3, 32, null, '1', '', '', '0', 3, '0', '1', 1, '', '', '', null, '0', '0', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', 'AF78BD91C0BA4A209AD0A9390F64DDF6', '业务类型名称', 'BUSINTYPENAME', 3, 100, null, '1', '', '', '0', 5, '0', '1', 1, '', '', '', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', 'C72343C1B3084F3AAAEDCD51D619548D', '刷新标志', 'NEEDUPDATE', 3, 4000, 0, '1', '', '', '0', 10, '0', '1', 1, '刷新标志', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '刷新标志', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', 'E0681C22DE5B4BD6AE2EEB1AECCD4345', '项目名称', 'PROJECTID', 6, 32, null, '1', '', '14DADAE88B8B57D0E050A8C0210557DD', '0', 7, '0', '1', 1, '', '', '4', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', 'EC9DDC66033F498995C52FF74FFAD14D', '专项名称', 'SPFID', 6, 32, null, '1', '', '14DADAE88B8B57D0E050A8C0210557DD', '0', 9, '0', '1', 1, '', '', '4', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '080001', 'EF7CEBA05CC546D9AF815F2F60A45E12', '行标志', 'DATAKEY', 3, 32, 0, '1', 'sys_guid()', '', '0', 1, '0', '1', 1, '行标志', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '行标志', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'BF84DACD7EE642588590074AEBB55E2D', '', 'F1E42F2BE0C24B6596CF9FDDC7C3E51E', '批次ID', 'BATCHID', 3, 32, null, '1', '', '', '0', 4, '0', '1', 1, '', '', '', null, '0', '0', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');


    end;
 end loop;
 sys_p_recreate_views('BF84DACD7EE642588590074AEBB55E2D');
end;
--64_JS
