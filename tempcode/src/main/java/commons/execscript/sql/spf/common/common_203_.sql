BEGIN
execute immediate Q'{CREATE OR REPLACE VIEW CODE_T_CSMX AS
SELECT ESTID AS GUID,
       ESTMODELID AS CODE,
       ESTNAME AS NAME,
       '0' AS SUPERGUID,
       '1' AS ISLEAF,
       '1' AS LEVELNO,
       '0' AS SUPERID,
       ESTID AS ID,
       '1' AS ENDFLAG,
       1 AS LVLID,
       TO_CHAR(ROWNUM) AS SHOWID,
       STATUS
  FROM BGT_T_ESTIMATE}';
  
DELETE FROM P#DICT_T_MODELCODE WHERE tableid ='E1A35FB4D52A459399162F32298D74FF';
DELETE FROM P#DICT_T_FACTORCODE WHERE tableid ='E1A35FB4D52A459399162F32298D74FF';
   for v_row in (select * from pub_t_partition_divid t where t.year <> '*') loop 

insert into P#DICT_T_MODELCODE (YEAR, PROVINCE,APPID, FASPCSID, DBTABLENAME, TABLEID, NAME, DYNAMICWHERE, ISLVL, ISFASP, ISORGID, ISREPBASE, ORDERID, SQLCON, STATUS)
values (v_row.YEAR, v_row.DISTRICTID,'SPF', 'E1A35FB4D52A459399162F32298D74FF', 'CODE_T_CSMX', 'E1A35FB4D52A459399162F32298D74FF', '≤‚À„ƒ£–Õ', ' CODE = (  SELECT TABLEID FROM DICT_T_MODEL WHERE DEALTYPE =''2104'')', '0', '0', '0', '1', 1, null, '1');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '12486A273F96478EB2E35B8426E3935E', null, 1, 3, 'ENDFLAG', null, null, '0', '0', 'ENDFLAG', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '17C1CDE794C847E4851792677DD21767', null, 100, 3, 'NAME', null, null, '0', '0', 'NAME', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '18C35179796B4D37B2D0BABE9CD0C453', null, 1, 3, 'STATUS', null, null, '0', '0', 'STATUS', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '41BB6ABF93AC45ECB7895746D6E311CC', null, 32, 3, 'GUID', null, null, '0', '0', 'GUID', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '4B5CB65F5F2F4FBBA2FAD16F67157A9B', null, 1, 3, 'ISLEAF', null, null, '0', '0', 'ISLEAF', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '5133A29AB681476D8262A6312EB5C028', null, 32, 3, 'ID', null, null, '0', '0', 'ID', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '74434C3CADF4432DADB93FEE8EB4C763', null, 40, 3, 'SHOWID', null, null, '0', '0', 'SHOWID', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, '912A4084F9D6425F91027F95AC19C290', null, 32, 3, 'CODE', null, null, '0', '0', 'CODE', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, 'B11F2787035144A6B1761B9551A48B0E', null, 0, 1, 'LVLID', null, null, '0', '0', 'LVLID', null, 0, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, 'B6148966AD1A40B3A23305F9D5C25E07', null, 1, 3, 'SUPERGUID', null, null, '0', '0', 'SUPERGUID', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
VALUES (v_row.YEAR, v_row.DISTRICTID,null, 'D48441B4B2954D5ABCF94DECD3265D1A', null, 1, 3, 'SUPERID', null, null, '0', '0', 'SUPERID', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

insert into P#DICT_T_FACTORCODE (YEAR, PROVINCE,BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME,  DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
values (v_row.YEAR, v_row.DISTRICTID,null, 'FDC6583D64614907930F7942508BF1C6', null, 1, 3, 'LEVELNO', null, null, '0', '0', 'LEVELNO', null, null, '1', 'E1A35FB4D52A459399162F32298D74FF');

   END LOOP;
END;
--CODE_T_CSMX
