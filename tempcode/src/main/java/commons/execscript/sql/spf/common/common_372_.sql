DECLARE
begin

       /*插入dealtype*/
  delete from dict_t_dealtype where dealid='65_JS';
    Insert into dict_t_dealtype (APPID,DEALID,DEALNAME,ORDERID,NEEDCONFIG,ISUNIQUE) values ('SPF','65_JS','横向专项日志',89,'0','0');
    delete from P#dict_t_model WHERE tableid ='E9F7D4B1B1B14278ACF377BC57250123';
    delete from P#dict_t_factor where tableid ='E9F7D4B1B1B14278ACF377BC57250123';
  DELETE FROM dict_t_defaultcol WHERE dealid ='65_JS';
  insert into dict_t_defaultcol (DEALID, ORDERID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, CSID, ISPRIMARY, ISRESERVE, GUID, STATUS, DEFAULTVALUE, ISLOGICKEY, DEID, ISVISIBLE, ISUPDATE)
  values ('65_JS', 1, '行标识', 'DATAKEY', 3, 32, null, null, '1', '1', sys_guid(), '1',  null, '1', '080001', '0', '0');
   EXECUTE IMMEDIATE Q'/CREATE OR REPLACE VIEW SPF_T_XZBRZ AS
SELECT c.datakey,
       c.objectid,
       e.BUSITYPEID,
       c.BATCHID,
          (select title from BD_T_BATCH where batchid=c.batchid) title,
       e.AGENCYID TARGETAGENCYID,
     e.SOURCEBATCHID,
       (select busitypename from bd_t_busitype where BUSITYPEID = e.BUSITYPEID) busitypename,
       p.dbversion,
       p.agencyid,
       p.PROJTYPEID,
       p.SPFID,
       1 NEEDUPDATE,
       c.OBJSTATUS,
       1 ORDERID,
       p.BEGINYEAR FINYEAR,
       e.NODEID,
       e.WFSTATUS,
       c.DISTRICTID
  FROM SPF_T_BFLOW_LOG c, EFM_T_BFLOW_LOG e
  , spf_t_fbaseinfo p where c.spfid = p.spfid and c.spfid=c.objectid and e.BATCHID=c.BATCHID/';
 for v_row in(select * from pub_t_partition_divid t where t.year <> '*') loop
  begin
insert into P#dict_t_model (YEAR, PROVINCE, TABLEID, NAME, ORDERID, DBTABLENAME, TABLETYPE, ISSHOW, APPID, REMARK, SUITID, DEALTYPE, ISRESERVED, INPUTLVL, ISADD, SHORTTITLE, EXTPROP, BGTLVL, SECUSQL, ISSUMTAB, ISMAN, MAINUPTAB, RELATAB, TABSWHERE, ISPARTITION, STATUS, ISBAK, INITSQL, INITSQLTIME, ISTASK, ISALLDISTRICT, DESCFILE, ISALLYEAR, INITSQLBTNNAME, ISEXCELIMP, ISREADONLY, ISSAVEFORMULA)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '专项横向日志', 2, 'SPF_T_XZBRZ', '2', '1', 'SPF', '', 'FB12E708FE56425F82EF3D89FDE0D0EF', '65_JS', '0', '3', '0', '', '0000000000000000000000000000000', '', '', '0', '0', '', '', '', '0', '1', '', '', '1', '', '', '', '', '', '', '1', '0');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '10401', '227985CBC1394A2DAEE721DA7276585B', '预算单位', 'AGENCYID', 6, 32, null, '1', '', '1708CF6F853F76EDE050A8C0210507FC', '0', 6, '0', '1', 1, '预算单位', '', '4', null, '0', '1', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '预算单位', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', '33254DDA2B324645B6D152100BD6D004', '专项类别', 'PROJTYPEID', 6, 32, null, '1', '', '148830CAF3E61F78E050A8C021056ABE', '0', 7, '0', '1', 1, '', '', '4', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', '3891CDF500DA48B6B3DD31AE57424317', '专项资金名称', 'SPFID', 6, 32, null, '1', '', '14DADAE88B8B57D0E050A8C0210557DD', '0', 8, '0', '1', 1, '', '', '4', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', '3AD68D96D2FB482B94DF176E6CF57841', '业务类型名称', 'BUSITYPENAME', 3, 100, null, '1', '', '', '0', 5, '0', '1', 1, '', '', '', null, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '080001', '3EDC1BFF0281487EB552D3BA9631CC0E', '行标志', 'DATAKEY', 3, 32, 0, '1', 'sys_guid()', '', '0', 1, '0', '1', 1, '行标志', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '行标志', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', '4CDEADE6A6584Y70I0533A06A8C0BCC7', '标题', 'TITLE', 3, 500, 0, '1', '', '', '1', 22, '0', '1', 1, '', '', '0', 0, '0', '1', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', '7C7F77B38E5D4C9EA3E0D5C6FDE08645', '排序序号', 'ORDERID', 1, 9, 0, '1', '', '', '0', 10, '0', '1', 1, '排序序号', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '排序序号', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, '', '', '', '', '', '', '4DFE6244E736265DE0533906A8C0300F', '', 1, 3, 'OBJSTATUS', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '1', '0', '1', 1, '业务主体状态', '1', 23, '', '', 0, '0', null, '1', '0', 'E9F7D4B1B1B14278ACF377BC57250123', '', '0', '');

insert into P#DICT_T_FACTOR (YEAR, PROVINCE, ALIAS, BANDCOLUMNID, BANDREFDWCOL, BGTLVL, COLFORMAT, COLTIPS, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, EXTPROP, FRMCOLID, FRMTABID, HREFLOC, HREFPARMID, ISBANDCOL, ISHREF, OPENWINDOWTYPE, ISKEY, ISLEAF, ISREGEX, ISRESERVE, ISSUM, ISUPDATE, ISVIRTUAL, ISVISIBLE, LEVELNO, NAME, NULLABLE, ORDERID, REGEXPR, REGEXPRINFO, SCALE, SHOWFORMAT, SHOWWIDTH, STATUS, SUPERID, TABLEID, VIRCONTEXT, PARENTNODECANCHECK, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, '', '', '', '', '', '', '4E100A5761907E87E0533A06A8C0D432', '', 1, 3, 'WFSTATUS', '', '', '0000000000000000000000000000000', '', '', '', '', '0', '0', '0', '0', '1', '0', '0', '0', '1', '0', '1', 1, '当前状态', '1', 24, '', '', 0, '0', null, '1', '0', 'E9F7D4B1B1B14278ACF377BC57250123', '', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '10206', '827C078967454AAF8B749F9AD350B496', '财年', 'FINYEAR', 3, 4, 0, '1', '', '', '0', 11, '0', '1', 1, '财年', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '财年', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', '879F80BC31E04B9FBCEA7518D8C31172', '专项', 'OBJECTID', 3, 32, null, '1', '', '', '0', 2, '0', '1', 1, '', '', '', null, '0', '0', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', 'D2D43EBA23E94288AEA7B32F67A2BFCB', '批次ID', 'BATCHID', 3, 32, null, '1', '', '', '0', 4, '0', '1', 1, '', '', '', null, '0', '0', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', 'E67210FEC4D24A9BB6CCCD14BC96EED6', '刷新标志', 'NEEDUPDATE', 3, 4000, 0, '1', '', '', '0', 9, '0', '1', 1, '刷新标志', '', '', null, '0', '0', '1', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '刷新标志', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');

insert into P#dict_t_factor (YEAR, PROVINCE, TABLEID, DEID, COLUMNID, NAME, DBCOLUMNNAME, DATATYPE, DATALENGTH, SCALE, NULLABLE, DEFAULTVALUE, CSID, ISUPDATE, ORDERID, SUPERID, ISLEAF, LEVELNO, ALIAS, COLFORMAT, SHOWFORMAT, SHOWWIDTH, ISKEY, ISVISIBLE, ISRESERVE, ISSUM, ISREGEX, REGEXPR, REGEXPRINFO, ISBANDCOL, BANDREFDWCOL, EXTPROP, COLTIPS, FRMTABID, FRMCOLID, ISVIRTUAL, VIRCONTEXT, ISHREF, HREFLOC, HREFPARMID, BGTLVL, STATUS, BANDCOLUMNID, PARENTNODECANCHECK, OPENWINDOWTYPE, XLSXCOLUMNID)
values (v_row.year, v_row.districtid, 'E9F7D4B1B1B14278ACF377BC57250123', '', 'E8213906CAF146B7AC2E0885AF59C02C', '业务类型', 'BUSITYPEID', 3, 32, null, '1', '', '', '0', 3, '0', '1', 1, '', '', '', null, '0', '0', '0', '0', '0', '', '', '0', '', '0000000000000000000000000000000', '', '', '', '0', '', '0', '', '', '', '1', '', '0', '0', '');


    end;
 end loop;
 sys_p_recreate_views('E9F7D4B1B1B14278ACF377BC57250123');
end;
--65_JS
