  BEGIN
    EXECUTE IMMEDIATE Q'{CREATE OR REPLACE VIEW CODE_T_FCSSPF AS
--测算调用专项代码表
SELECT S.SPFID GUID,
               S.SPFNAME NAME,
              (SELECT AGENCY.NAME
                  FROM CODE_T_FIRAGENCY AGENCY
                 WHERE S.AGENCYID = AGENCY.GUID
               )AGENCYNAME,
               S.AGENCYID,
               S.PROJTYPEID,
               NVL(S.SPFCODE,'0') CODE,
               '0' SUPERGUID,
               '0' ISLEAF,
               '1' LEVELNO,
               '0' TASKTYPE,
               DEPTID,
               S.STATUS,
               S.PROVINCE,
               S.YEAR
          FROM P#SPF_T_FBASEINFO S
          WHERE S.STATUS = '1'}';
          --删除
    DELETE FROM P#DICT_T_MODELCODE WHERE TABLEID IN('4F0CD31B08F74223BECA9A607658CE14','43860AA96E7F30AEE0533A06A8C07C8E');
    DELETE FROM P#DICT_T_FACTORCODE WHERE TABLEID IN('4F0CD31B08F74223BECA9A607658CE14','43860AA96E7F30AEE0533A06A8C07C8E');
   --重新增加
   FOR v_row IN (SELECT * FROM PUB_T_PARTITION_DIVID T WHERE T.YEAR <> '*') LOOP 
     INSERT INTO P#DICT_T_MODELCODE (YEAR, PROVINCE, APPID, FASPCSID, DBTABLENAME, TABLEID, NAME, DYNAMICWHERE, ISLVL, ISFASP, ISORGID, ISREPBASE, ORDERID, SQLCON, STATUS, TABLETYPE)
     VALUES (v_row.YEAR, v_row.DISTRICTID, 'SPF', '4F0CD31B08F74223BECA9A607658CE14', 'CODE_T_FCSSPF', '4F0CD31B08F74223BECA9A607658CE14', '专项代码表（测算用）', null, '0', '0', '0', '1', 1, null, '1', '2');
      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '9AD09EE449D64272B57161EF0F675EE3', null, 32, 3, 'GUID', '0', '080001', '0', '0', '唯一标识', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '07587B53185F4B63B315A079846553EE', null, 200, 3, 'NAME', '0', null, '0', '0', '专项名称', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '2A32803C0A4946A5B0DB8B2D783959F1', null, 266, 3, 'AGENCYNAME', '0', null, '0', '0', '单位名称', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '5FF28ED4815A4FE094225410E6394A8F', null, 32, 3, 'AGENCYID', null, null, '0', '0', 'AGENCYID', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, 'F003AF20FD704CC6A58FC419AFEE3495', null, 32, 3, 'PROJTYPEID', '0', null, '0', '0', '专项类别', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, 'F507CDFD4F1B4629B7459B941B4D54EA', null, 150, 3, 'CODE', null, null, '0', '0', 'CODE', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '930E5CF9E15D41FFA2E77C291EDF26A2', null, 1, 3, 'SUPERGUID', null, null, '0', '0', 'SUPERGUID', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '7602F8293D6B476FA6A25DBB30BBA8B1', null, 1, 3, 'ISLEAF', null, null, '0', '0', 'ISLEAF', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '78773277E18443AAAB16CA1A42EA54BA', null, 1, 3, 'LEVELNO', null, null, '0', '0', 'LEVELNO', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, 'A6C0F1C3B80249B68589760C599FEF0D', null, 1, 3, 'TASKTYPE', null, null, '0', '0', 'TASKTYPE', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '1EC8180F0BD24067B9314D7BF724EE6C', null, 32, 3, 'DEPTID', '0', null, '0', '0', '处室名称', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '89895D57D38B421FB3D3E3DDF9BBCFF5', null, 1, 3, 'STATUS', null, null, '0', '0', 'STATUS', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '80873F934708447A928183BF2AC15759', null, 9, 3, 'PROVINCE', null, null, '0', '0', 'PROVINCE', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '737E22E1EB9E4F2EA55CA5FC41E366B2', null, 4, 3, 'YEAR', null, null, '0', '0', 'YEAR', null, null, '1', '4F0CD31B08F74223BECA9A607658CE14');
 
     INSERT INTO P#DICT_T_MODELCODE (YEAR, PROVINCE, APPID, FASPCSID, DBTABLENAME, TABLEID, NAME, DYNAMICWHERE, ISLVL, ISFASP, ISORGID, ISREPBASE, ORDERID, SQLCON, STATUS, TABLETYPE)
      VALUES (v_row.YEAR, v_row.DISTRICTID, 'SPF', '43860AA96E7F30AEE0533A06A8C07C8E', 'CODE_T_FCSSPF', '43860AA96E7F30AEE0533A06A8C07C8E', '专项代码表（测算用）', null, '0', '0', '0', '1', 1, null, '1', '2');
      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07001', null, 32, 3, 'GUID', '0', '080001', '0', '0', '唯一标识', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07002', null, 200, 3, 'NAME', '0', null, '0', '0', '专项名称', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07003', null, 266, 3, 'AGENCYNAME', '0', null, '0', '0', '单位名称', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07004', null, 32, 3, 'AGENCYID', null, null, '0', '0', 'AGENCYID', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07005', null, 32, 3, 'PROJTYPEID', '0', null, '0', '0', '专项类别', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07006', null, 150, 3, 'CODE', null, null, '0', '0', 'CODE', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07007', null, 1, 3, 'SUPERGUID', null, null, '0', '0', 'SUPERGUID', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07008', null, 1, 3, 'ISLEAF', null, null, '0', '0', 'ISLEAF', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07009', null, 1, 3, 'LEVELNO', null, null, '0', '0', 'LEVELNO', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07010', null, 1, 3, 'TASKTYPE', null, null, '0', '0', 'TASKTYPE', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07011', null, 32, 3, 'DEPTID', '0', null, '0', '0', '处室名称', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07012', null, 1, 3, 'STATUS', null, null, '0', '0', 'STATUS', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07013', null, 9, 3, 'PROVINCE', null, null, '0', '0', 'PROVINCE', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');

      insert into P#DICT_T_FACTORcode (YEAR, PROVINCE, BGTLVL, COLUMNID, CSID, DATALENGTH, DATATYPE, DBCOLUMNNAME, DEFAULTVALUE, DEID, ISRESERVE, ISVISIBLE, NAME, ORDERID, SCALE, STATUS, TABLEID)
      values (v_row.YEAR, v_row.DISTRICTID, null, '43860AA96E7F30AEE0533A06A8C07014', null, 4, 3, 'YEAR', null, null, '0', '0', 'YEAR', null, null, '1', '43860AA96E7F30AEE0533A06A8C07C8E');
     END LOOP;
     UPDATE P#DICT_T_FACTOR SET CSID ='4F0CD31B08F74223BECA9A607658CE14'
     WHERE CSID ='14DADAE88B8B57D0E050A8C0210557DD' AND TABLEID IN
     (SELECT TABLEID FROM DICT_T_MODEL WHERE APPID ='SPF');
     UPDATE P#DICT_T_FACTOR SET CSID ='43860AA96E7F30AEE0533A06A8C07C8E'
     WHERE CSID ='BD7D2B5EA9A646CC8D5236D2A872BE9E' 
     AND columnid ='30EE8D3BB0CF4356B0162CA9683A3918';
   END;
   
--新增专项代码表